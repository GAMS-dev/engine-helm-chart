{{- $secretName := "gamsworker" -}}
{{- $existingSecret := lookup "v1" "Secret" .Release.Namespace $secretName }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ $secretName }}
  namespace: {{ .Release.Namespace }}
type: Opaque
stringData:
  GMS_RUNNER_DATABASE_ADMIN_PWD: "{{ required "value 'gmsRunnerDatabaseAdminPwd' is required" .Values.gmsRunnerDatabaseAdminPwd }}"
  GMS_RUNNER_DATABASE_BROKER_PWD: "{{ required "value 'gmsRunnerDatabaseBrokerPwd' is required" .Values.gmsRunnerDatabaseBrokerPwd }}"
  GMS_RUNNER_DATABASE_WORKER_PWD: "{{ required "value 'gmsRunnerDatabaseWorkerPwd' is required" .Values.gmsRunnerDatabaseWorkerPwd }}"
  GMS_RUNNER_DATABASE_CLEANER_PWD: "{{ required "value 'gmsRunnerDatabaseCleanerPwd' is required" .Values.gmsRunnerDatabaseCleanerPwd }}"
  GMS_RUNNER_DATABASE_SPWN_PWD: "{{ required "value 'gmsRunnerDatabaseSpwnPwd' is required" .Values.gmsRunnerDatabaseSpwnPwd }}"
  GMS_RUNNER_DATABASE_K8S_CANCEL_PWD: "{{ required "value 'gmsRunnerDatabaseK8sCancelPwd' is required" .Values.gmsRunnerDatabaseK8sCancelPwd }}"
  GMS_RUNNER_DATABASE_DEPENDENCY_CHECK_PWD: "{{ required "value 'gmsRunnerDatabaseDependencyCheckPwd' is required" .Values.gmsRunnerDatabaseDependencyCheckPwd }}"
  GMS_RUNNER_DATABASE_EVENT_MANAGER_PWD: "{{ required "value 'gmsRunnerDatabaseEventManagerPwd' is required" .Values.gmsRunnerDatabaseEventManagerPwd }}"
  GMS_RUNNER_DATABASE_K8S_JOB_WATCHER_PWD: "{{ required "value 'gmsRunnerDatabaseK8sJobWatcherPwd' is required" .Values.gmsRunnerDatabaseK8sJobWatcherPwd }}"
  GMS_RUNNER_PGBOUNCER_USERLIST: '"broker" "{{ .Values.gmsRunnerDatabaseBrokerPwd }}"'
  GMS_RUNNER_MONGO_BROKER_PWD: "{{ required "value 'gmsRunnerMongoBrokerPwd' is required" .Values.gmsRunnerMongoBrokerPwd }}"
  GMS_RUNNER_MONGO_WORKER_PWD: "{{ required "value 'gmsRunnerMongoWorkerPwd' is required" .Values.gmsRunnerMongoWorkerPwd }}"
  GMS_RUNNER_MONGO_HYPERCUBE_APPENDER_PWD: "{{ required "value 'gmsRunnerMongoHypercubeAppenderPwd' is required" .Values.gmsRunnerMongoHypercubeAppenderPwd }}"
  GMS_RUNNER_MONGO_CLEANER_PWD: "{{ required "value 'gmsRunnerMongoCleanerPwd' is required" .Values.gmsRunnerMongoCleanerPwd }}"
  GMS_RUNNER_MONGO_SPWN_PWD: "{{ required "value 'gmsRunnerMongoSpwnPwd' is required" .Values.gmsRunnerMongoSpwnPwd }}"
  GMS_RUNNER_MONGO_K8S_CANCEL_PWD: "{{ required "value 'gmsRunnerMongoK8sCancelPwd' is required" .Values.gmsRunnerMongoK8sCancelPwd }}"
  GMS_RUNNER_MONGO_DEPENDENCY_CHECK_PWD: "{{ required "value 'gmsRunnerMongoDependencyCheckPwd' is required" .Values.gmsRunnerMongoDependencyCheckPwd }}"
  GMS_RUNNER_MONGO_EVENT_MANAGER_PWD: "{{ required "value 'gmsRunnerDatabaseEventManagerPwd' is required" .Values.gmsRunnerMongoEventManagerPwd }}"
  GMS_RUNNER_MONGO_FORWARD_PROXY_PWD: "{{ required "value 'gmsRunnerDatabaseEventManagerPwd' is required" .Values.gmsRunnerMongoForwardProxyPwd }}"
  GMS_RUNNER_MONGO_K8S_JOB_WATCHER_PWD: "{{ required "value 'gmsRunnerMongoK8sJobWatcherPwd' is required" .Values.gmsRunnerMongoK8sJobWatcherPwd }}"
  GMS_RUNNER_FORWARD_PROXY_PWD: "{{ required "value 'gmsRunnerForwardProxyPwd' is required" .Values.gmsRunnerForwardProxyPwd }}"
  GMS_RUNNER_FORWARD_PROXY_SECRET: "{{ required "value 'gmsRunnerForwardProxySecret' is required" .Values.gmsRunnerForwardProxySecret }}"
  GMS_RUNNER_FORWARD_PROXY_ENC_KEY: "{{ required "value 'gmsRunnerForwardProxyEncKey' is required" .Values.gmsRunnerForwardProxyEncKey }}"
  GMS_RUNNER_RABBIT_BROKER_PWD: {{ if $existingSecret }}{{ (index $existingSecret.data "GMS_RUNNER_RABBIT_BROKER_PWD") | b64dec }}{{ else }}{{ randAlphaNum 32 }}{{ end }}
  GMS_RUNNER_RABBIT_WORKER_PWD: {{ if $existingSecret }}{{ (index $existingSecret.data "GMS_RUNNER_RABBIT_WORKER_PWD") | b64dec }}{{ else }}{{ randAlphaNum 32 }}{{ end }}
  GMS_RUNNER_RABBIT_HYPERCUBE_APPENDER_PWD: {{ if $existingSecret }}{{ (index $existingSecret.data "GMS_RUNNER_RABBIT_HYPERCUBE_APPENDER_PWD") | b64dec }}{{ else }}{{ randAlphaNum 32 }}{{ end }}
  GMS_RUNNER_RABBIT_CLEANER_PWD: {{ if $existingSecret }}{{ (index $existingSecret.data "GMS_RUNNER_RABBIT_CLEANER_PWD") | b64dec }}{{ else }}{{ randAlphaNum 32 }}{{ end }}
  GMS_RUNNER_RABBIT_HYPERCUBE_UNPACKER_PWD: {{ if $existingSecret }}{{ (index $existingSecret.data "GMS_RUNNER_RABBIT_HYPERCUBE_UNPACKER_PWD") | b64dec }}{{ else }}{{ randAlphaNum 32 }}{{ end }}
  GMS_RUNNER_RABBIT_MIGRATE_PWD: {{ if $existingSecret }}{{ (index $existingSecret.data "GMS_RUNNER_RABBIT_MIGRATE_PWD") | b64dec }}{{ else }}{{ randAlphaNum 32 }}{{ end }}
  GMS_RUNNER_RABBIT_SPWN_PWD: {{ if $existingSecret }}{{ (index $existingSecret.data "GMS_RUNNER_RABBIT_SPWN_PWD") | b64dec }}{{ else }}{{ randAlphaNum 32 }}{{ end }}
  GMS_RUNNER_RABBIT_K8S_CANCEL_PWD: {{ if $existingSecret }}{{ (index $existingSecret.data "GMS_RUNNER_RABBIT_K8S_CANCEL_PWD") | b64dec }}{{ else }}{{ randAlphaNum 32 }}{{ end }}
  GMS_RUNNER_RABBIT_DEPENDENCY_CHECK_PWD: {{ if $existingSecret }}{{ (index $existingSecret.data "GMS_RUNNER_RABBIT_DEPENDENCY_CHECK_PWD") | b64dec }}{{ else }}{{ randAlphaNum 32 }}{{ end }}
  GMS_RUNNER_RABBIT_EVENT_MANAGER_PWD: {{ if $existingSecret }}{{ (index $existingSecret.data "GMS_RUNNER_RABBIT_EVENT_MANAGER_PWD") | b64dec }}{{ else }}{{ randAlphaNum 32 }}{{ end }}
  GMS_RUNNER_RABBIT_K8S_JOB_WATCHER_PWD: {{ if $existingSecret }}{{ (index $existingSecret.data "GMS_RUNNER_RABBIT_K8S_JOB_WATCHER_PWD") | b64dec }}{{ else }}{{ randAlphaNum 32 }}{{ end }}
